<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ten Commandment Versions</title>

    <!-- Load ALL Translation Data Files from translations/ folder -->
    <script src="translations/web.js" defer></script>
    <script src="translations/kjv.js" defer></script>
    <script src="translations/asv.js" defer></script>
    <script src="translations/darby.js" defer></script>
    <script src="translations/dra.js" defer></script>
    <script src="translations/ylt.js" defer></script>
    <script src="translations/rva.js" defer></script>
    <script src="translations/vulgate.js" defer></script>

    <!-- CSS Styles -->
    <style>
        /* --- Basic Styling --- */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 1em; background-color: #f4f4f4; color: #333; line-height: 1.6; }
        .container { max-width: 1600px; margin: 0 auto; background-color: #fff; padding: 1.5em; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow-x: hidden; }
        h1 { text-align: center; margin-bottom: 1em; color: #003366; font-size: 1.8em; }
        /* Titles Styling */
        h2 { margin: 0; font-size: 1.15em; color: #0056b3; padding: 0 0.2em 0.3em 0.2em; text-align: center; font-weight: 600; overflow-wrap: break-word; hyphens: auto; }
        footer { text-align: center; margin-top: 3em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.85em; color: #6c757d; }

        /* --- Selectors Area Layout --- */
        .selectors-area { display: flex; justify-content: space-around; gap: 2em; margin-bottom: 2em; padding: 1em; background-color: #e9ecef; border-radius: 8px; flex-wrap: wrap; }
        .selector-group { display: flex; flex-direction: column; gap: 0.8em; align-items: center; min-width: 300px; flex: 1; }
        /* Denomination chooser/pill styling */
        .denomination-chooser { text-align: center; min-height: 30px; width: 100%; }
        .denomination-chooser span { display: inline-block; padding: 0.4em 0.8em; margin: 0.2em; background-color: #fff; border: 1px solid #ccc; border-radius: 15px; cursor: pointer; font-size: 0.85em; transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out, transform 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }
        .denomination-chooser span:hover:not(.selected) { background-color: #e2e6ea; border-color: #adb5bd; transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.08); }
        .denomination-chooser span.selected { background-color: #0056b3; color: #fff; border-color: #004085; font-weight: bold; box-shadow: 0 1px 2px rgba(0,0,0,0.1) inset; }
        .denomination-chooser .placeholder { font-size: 0.9em; color: #6c757d; }
        /* Translation selector styling */
        .translation-select-wrapper { text-align: center; width: 90%; }
        .translation-select-wrapper label { margin-right: 0.5em; font-size: 0.9em; font-weight: 500; color: #495057; }
        .translation-select-wrapper select { padding: 0.4em 0.6em; border: 1px solid #ced4da; border-radius: 4px; font-size: 0.9em; width: 100%; box-sizing: border-box; }

        /* --- Titles Area Layout (ALWAYS 2 columns) --- */
        .titles-area { display: grid; grid-template-columns: 1fr 1fr; gap: 1em; margin-bottom: 1em; padding: 0 0.5em; min-height: 1.5em; align-items: start; }

        /* --- Comparison Grid Layout (Uses minmax for proportional shrinking) --- */
        .comparison-grid { display: grid; grid-template-columns: minmax(0, 1fr) minmax(0, 1fr); grid-auto-rows: auto; gap: 1em 1.5em; border-top: 2px solid #dee2e6; padding-top: 1em; }

        /* --- Grid Cell Styling (Added box-sizing and hyphens) --- */
        .grid-cell {
            padding: 1em; background-color: #fdfdff; border: 1px solid #eee; border-radius: 4px; align-self: start; min-height: 50px;
            overflow-wrap: break-word; /* Wrap long words */
            hyphens: auto; /* Enable hyphenation */
            min-width: 0; /* Help grid items shrink */
            box-sizing: border-box; /* Include padding/border in width calculation */
        }

        /* Content Styling */
        .preamble-text { font-style: italic; color: #555; margin-bottom: 1em; padding: 0.5em; background-color: #f0f0f0; border-left: 3px solid #6c757d; border-radius: 3px; max-width: 100%; }
        .commandment-text { margin-bottom: 0.8em; padding-left: 0.5em; border-left: 3px solid #007bff; max-width: 100%; }
        .commandment-text:last-child { margin-bottom: 0; }
        .placeholder { color: #6c757d; font-style: italic; text-align: center; padding: 2em 0; }
        .error-message { color: #dc3545; font-weight: bold; text-align: center; padding: 1em; border: 1px solid #f5c6cb; background-color: #f8d7da; border-radius: 5px;}
        .translation-note { display: block; font-size: 0.75em; color: #aaa; margin-top: 0.8em; text-align: right; }

        /* --- Responsive Styles --- */

        /* Medium Screens */
        @media (max-width: 992px) {
            .container { padding: 1em; }
            h2 { font-size: 1.1em; }
            .comparison-grid { gap: 1em 1em; }
            .selector-group { min-width: 250px; }
        }

        /* Small screens (Phones) - Stack Selectors and Grid Columns, reduce title size */
        @media (max-width: 300px) {
            body { padding: 0.5em; }
            .container { padding: 0.5em; }
            h1 { font-size: 1.3em; }
            /* Titles remain side-by-side, just reduce font size */
            h2 { font-size: 0.95em; }

            /* Stack selector groups */
            .selectors-area { flex-direction: column; align-items: stretch; gap: 1em; }
            .selector-group { min-width: unset; width: 100%; box-sizing: border-box; }
            .translation-select-wrapper { width: 95%; max-width: 400px; margin-left: auto; margin-right: auto; }
            .denomination-chooser span { font-size: 0.75em; }

            /* Stack comparison grid columns */
            .comparison-grid {
                grid-template-columns: minmax(0, 1fr); /* Define ONLY ONE column */
                gap: 1em; /* Row gap only */
            }

            /* --- Force cells into the single column --- */
            /* Target ALL grid cells within the grid at this breakpoint */
            .comparison-grid > .grid-cell {
                /* Explicitly assign ALL cells to the first (and only) column track */
                grid-column: 1 / span 1;
                 /* Reset any potentially conflicting inline styles (using !important as a last resort if needed, but try without first) */
                 /* grid-column: 1 / span 1 !important; */

                width: 100%; /* Ensure it tries to take full width */
                box-sizing: border-box; /* Include padding in width */
                padding: 0.6em;
                min-width: unset; /* Remove any min-width constraints */
            }

            /* Text size adjustments */
            .commandment-text { font-size: 0.85em; line-height: 1.45; }
            .preamble-text { font-size: 0.8em; line-height: 1.45; }
        } /* End @media (max-width: 768px) */

    </style>
</head>

<body>

    <div class="container">
        <h1>Ten Commandment Versions</h1>

        <!-- Selection Controls Area -->
        <div class="selectors-area">
            <div class="selector-group">
                <div class="denomination-chooser" id="chooser-col1"><span class="placeholder">Loading...</span></div>
                <div class="translation-select-wrapper">
                    <label for="translation-select-col1">Translation 1:</label>
                    <select id="translation-select-col1"></select>
                </div>
            </div>
             <div class="selector-group">
                <div class="denomination-chooser" id="chooser-col2"><span class="placeholder">Loading...</span></div>
                <div class="translation-select-wrapper">
                    <label for="translation-select-col2">Translation 2:</label>
                    <select id="translation-select-col2"></select>
                </div>
            </div>
        </div>

        <!-- Titles Area (Always 2 columns) -->
        <div class="titles-area">
             <h2 id="title-col1">Version 1</h2>
             <h2 id="title-col2">Version 2</h2>
        </div>

        <!-- Comparison Grid Area -->
        <div id="comparison-grid" class="comparison-grid">
             <div class="placeholder" style="grid-column: 1 / span 2;">Select versions above to compare.</div>
        </div>


        <footer>
            <p>Texts sourced from various translations. Ensure accuracy by consulting primary sources. Educational use only.</p>
        </footer>

    </div> <!-- End Container -->


     <!-- Main Application Script -->
     <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Constants ---
            const TRANSLATIONS = { "ASV": "American Standard Version (ASV)", "DARBY": "Darby Translation (DARBY)", "DRA": "Douay-Rheims 1899 (DRA)", "KJV": "King James Version (KJV)", "WEB": "World English Bible (WEB)", "YLT": "Young's Literal Translation (YLT)", "RVA": "Reina-Valera Antigua (RVA)", "VULGATE": "Biblia Sacra Vulgata (VULGATE)" };
            const DEFAULT_TRANSLATION_KEY = 'WEB';
            const TRANSLATION_DATA_MAP = { "WEB": typeof webTranslationData !== 'undefined' ? webTranslationData : null, "KJV": typeof kjvTranslationData !== 'undefined' ? kjvTranslationData : null, "ASV": typeof asvTranslationData !== 'undefined' ? asvTranslationData : null, "DARBY": typeof darbyTranslationData !== 'undefined' ? darbyTranslationData : null, "DRA": typeof draTranslationData !== 'undefined' ? draTranslationData : null, "YLT": typeof yltTranslationData !== 'undefined' ? yltTranslationData : null, "RVA": typeof rvaTranslationData !== 'undefined' ? rvaTranslationData : null, "VULGATE": typeof vulgateTranslationData !== 'undefined' ? vulgateTranslationData : null };
            const MAX_COMMANDMENT_NUM = 10;

            // --- State Variables ---
            let selectedDenominationKey1 = null;
            let selectedDenominationKey2 = null;
            let selectedTranslationKey1 = DEFAULT_TRANSLATION_KEY;
            let selectedTranslationKey2 = DEFAULT_TRANSLATION_KEY;

            // --- DOM References ---
            const chooserCol1 = document.getElementById('chooser-col1');
            const chooserCol2 = document.getElementById('chooser-col2');
            const translationSelectCol1 = document.getElementById('translation-select-col1');
            const translationSelectCol2 = document.getElementById('translation-select-col2');
            const comparisonGrid = document.getElementById('comparison-grid');
            const titleCol1 = document.getElementById('title-col1');
            const titleCol2 = document.getElementById('title-col2');

            // --- Helper: Shorten Name ---
            function getShortName(fullName) {
                if (!fullName) return '';
                return fullName.replace(/\s*\(.*\)\s*$/, '').trim();
            }

            // --- Helper: Get Denomination Data Safely ---
             function getDenominationData(denominationKey, translationKey) {
                let translationData = TRANSLATION_DATA_MAP[translationKey];
                let actualTranslationKeyUsed = translationKey;
                if (!translationData) {
                    translationData = TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY];
                    actualTranslationKeyUsed = DEFAULT_TRANSLATION_KEY;
                }
                if (!translationData) return { data: null, translationKeyUsed: null, error: `Missing default data (${DEFAULT_TRANSLATION_KEY})` };
                const denominationData = translationData[denominationKey];
                if (!denominationData) return { data: null, translationKeyUsed: actualTranslationKeyUsed, error: `Missing denomination (${denominationKey || 'None selected'}) in translation ${actualTranslationKeyUsed}` };
                return { data: denominationData, translationKeyUsed: actualTranslationKeyUsed, error: null };
             }

             // --- Helper: Get Commandment Text Parts for a Specific Number ---
             function getCommandmentPartsForNumber(denominationData, targetNumber, denominationKey) {
                 const result = { preamble: null, commandments: [] };
                 if (!denominationData || !denominationData.commandments) return result;
                 if (targetNumber === 1 && denominationData.preamble && (denominationKey === 'Jewish' || denominationKey === 'Protestant')) {
                     result.preamble = denominationData.preamble;
                 }
                 denominationData.commandments.forEach((cmdText, index) => {
                     const numberMatch = cmdText.match(/^(\d+)\.?\s/);
                     const cmdNumber = numberMatch ? parseInt(numberMatch[1], 10) : (index + 1);
                     if (cmdNumber === targetNumber) {
                          if (!(targetNumber === 9 && (denominationKey === 'Catholic' || denominationKey === 'Lutheran') && /covet|desire|codiciar|concupisces/i.test(cmdText))) {
                             result.commandments.push(cmdText);
                         }
                     }
                     else if (targetNumber === 10 && cmdNumber === 9 && (denominationKey === 'Catholic' || denominationKey === 'Lutheran')) {
                         if (/covet|desire|codiciar|concupisces/i.test(cmdText)) {
                             result.commandments.push(cmdText);
                         }
                     }
                 });
                 return result;
             }

            // --- Helper: Update Display (Grid Logic) ---
            function updateDisplay() {
                comparisonGrid.innerHTML = ''; // Clear grid
                const result1 = getDenominationData(selectedDenominationKey1, selectedTranslationKey1);
                const result2 = getDenominationData(selectedDenominationKey2, selectedTranslationKey2);

                // Update Titles - Use shortened name
                const name1 = result1.data?.name || selectedDenominationKey1 || 'Version 1';
                const name2 = result2.data?.name || selectedDenominationKey2 || 'Version 2';
                titleCol1.textContent = getShortName(name1);
                titleCol2.textContent = getShortName(name2);

                // Error handling for missing default data
                 let hasFatalError = false;
                 if (result1.error && !result1.data && result1.error.includes("Missing default data")) hasFatalError = true;
                 if (result2.error && !result2.data && result2.error.includes("Missing default data")) hasFatalError = true;
                 if(hasFatalError){
                     comparisonGrid.innerHTML = `<div class="error-message" style="grid-column: 1 / span 2;">Fatal Error: Default translation data file (${DEFAULT_TRANSLATION_KEY}.js) missing or invalid.</div>`;
                     return;
                 }

                // Loop through Commandment Numbers
                for (let i = 1; i <= MAX_COMMANDMENT_NUM; i++) {
                     const createCell = (colNum, result, denominationKey) => {
                        const cell = document.createElement('div');
                        cell.className = 'grid-cell';
                        // Set inline style for grid column - this will be overridden by CSS below 768px
                        cell.style.gridColumn = `${colNum}`;
                        cell.style.gridRow = `${i}`;

                        if (result.data) {
                            const parts = getCommandmentPartsForNumber(result.data, i, denominationKey);
                            let cellHTML = '';
                            if (parts.preamble) { cellHTML += `<div class="preamble-text">${parts.preamble}</div>`; }
                            if (parts.commandments.length > 0) { cellHTML += parts.commandments.map(text => `<p class="commandment-text">${text || "[Text missing]"}</p>`).join(''); }
                            if (cellHTML.length > 0 || parts.preamble) { cellHTML += `<span class="translation-note">(Using ${TRANSLATIONS[result.translationKeyUsed] || result.translationKeyUsed})</span>`; }
                            cell.innerHTML = cellHTML || ' '; // Use non-breaking space if empty
                        } else {
                            if(denominationKey){ cell.innerHTML = `<p class="placeholder">${result.error || 'Data unavailable'}</p>`; }
                            else { cell.innerHTML = ` `; }
                        }
                        return cell;
                    };
                     comparisonGrid.appendChild(createCell(1, result1, selectedDenominationKey1));
                     comparisonGrid.appendChild(createCell(2, result2, selectedDenominationKey2));
                }

                updateChooserSelection(chooserCol1, selectedDenominationKey1);
                updateChooserSelection(chooserCol2, selectedDenominationKey2);
            } // End updateDisplay

            // --- Other Helpers and Event Handlers ---
            function updateChooserSelection(chooserElement, selectedKey) {
                 chooserElement.querySelectorAll('span[data-key]').forEach(span => {
                     span.classList.toggle('selected', span.dataset.key === selectedKey);
                 });
            }
            function populateTranslationSelect(selectElement) {
                 Object.entries(TRANSLATIONS).forEach(([key, name]) => {
                     const option = document.createElement('option'); option.value = key; option.textContent = name;
                     if (key === DEFAULT_TRANSLATION_KEY) option.selected = true;
                     selectElement.appendChild(option);
                 });
             }
            function handleDenominationClick(event, columnNumber) {
                const target = event.target;
                if (target.tagName === 'SPAN' && target.dataset.key) {
                    const key = target.dataset.key;
                    if (columnNumber === 1 && key === selectedDenominationKey1) return;
                    if (columnNumber === 2 && key === selectedDenominationKey2) return;
                    if (columnNumber === 1) selectedDenominationKey1 = key;
                    else selectedDenominationKey2 = key;
                    updateDisplay();
                }
            }
            function handleTranslationChange(event, columnNumber) {
                const selectedValue = event.target.value;
                 if (columnNumber === 1) selectedTranslationKey1 = selectedValue;
                 else selectedTranslationKey2 = selectedValue;
                 updateDisplay();
            }

            // --- Initialization Function ---
            function initializeApp() {
                 if (!TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]) {
                     console.error(`Fatal Error: Default translation data (${DEFAULT_TRANSLATION_KEY}) not loaded! Check if ${DEFAULT_TRANSLATION_KEY}.js exists and defines its variable.`);
                     comparisonGrid.innerHTML = `<div class="error-message" style="grid-column: 1 / span 2;">Fatal Error: Core data file missing. Cannot initialize application.</div>`;
                     chooserCol1.innerHTML = ''; chooserCol2.innerHTML = ''; return;
                 }
                populateTranslationSelect(translationSelectCol1);
                populateTranslationSelect(translationSelectCol2);
                chooserCol1.innerHTML = ''; chooserCol2.innerHTML = '';
                const denominationKeys = Object.keys(TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]);
                denominationKeys.sort((a, b) => {
                    const nameA = TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]?.[a]?.name || a;
                    const nameB = TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]?.[b]?.name || b;
                    return nameA.localeCompare(nameB);
                });
                denominationKeys.forEach(key => {
                    const fullName = TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]?.[key]?.name || key;
                    const shortName = getShortName(fullName);
                    const span1 = document.createElement('span'); span1.textContent = shortName; span1.dataset.key = key; chooserCol1.appendChild(span1);
                    const span2 = document.createElement('span'); span2.textContent = shortName; span2.dataset.key = key; chooserCol2.appendChild(span2);
                });
                chooserCol1.addEventListener('click', (event) => handleDenominationClick(event, 1));
                chooserCol2.addEventListener('click', (event) => handleDenominationClick(event, 2));
                translationSelectCol1.addEventListener('change', (event) => handleTranslationChange(event, 1));
                translationSelectCol2.addEventListener('change', (event) => handleTranslationChange(event, 2));
                selectedTranslationKey1 = translationSelectCol1.value;
                selectedTranslationKey2 = translationSelectCol2.value;
                updateDisplay();
            } // End initializeApp

            // --- Run Initialization ---
            initializeApp();

        }); // End DOMContentLoaded
    </script>

</body>
</html>