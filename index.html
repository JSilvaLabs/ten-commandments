<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 1. Update Title Tag -->
    <title>Ten Commandment Versions</title>

    <!-- Load ALL Translation Data Files -->
    <script src="translations/web.js" defer></script>
    <script src="translations/kjv.js" defer></script>
    <script src="translations/asv.js" defer></script>
    <script src="translations/darby.js" defer></script>
    <script src="translations/dra.js" defer></script>
    <script src="translations/ylt.js" defer></script>
    <script src="translations/rva.js" defer></script>
    <script src="translations/vulgate.js" defer></script>

    <!-- CSS Styles -->
    <style>
        /* --- Basic Styling (mostly unchanged) --- */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 1em; background-color: #f4f4f4; color: #333; line-height: 1.6; } /* Adjusted padding */
        .container { max-width: 1600px; margin: 0 auto; background-color: #fff; padding: 1.5em; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); } /* Adjusted padding */
        h1 { text-align: center; margin-bottom: 1em; color: #003366; font-size: 1.8em; } /* Adjusted size */
        h2 { margin: 0; font-size: 1.15em; color: #0056b3; padding-bottom: 0.3em; text-align: center; font-weight: 600; } /* Adjusted size/weight */
        footer { text-align: center; margin-top: 3em; padding-top: 1em; border-top: 1px solid #eee; font-size: 0.85em; color: #6c757d; }

        /* --- Selectors Area Layout (unchanged) --- */
        .selectors-area { display: flex; justify-content: space-around; gap: 2em; margin-bottom: 2em; padding: 1em; background-color: #e9ecef; border-radius: 8px; flex-wrap: wrap; }
        .selector-group { display: flex; flex-direction: column; gap: 0.8em; align-items: center; min-width: 300px; flex: 1; } /* Adjusted min-width */
        /* Denomination chooser/pill styling */
        .denomination-chooser { text-align: center; min-height: 30px; }
        .denomination-chooser span {
            display: inline-block;
            padding: 0.4em 0.8em;
            margin: 0.2em;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.85em; /* Slightly smaller */
            /* 3. Improvement: Add transition */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out, transform 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
         /* 3. Improvement: Hover effect for non-selected pills */
        .denomination-chooser span:hover:not(.selected) {
            background-color: #e2e6ea;
            border-color: #adb5bd;
            transform: translateY(-1px); /* Subtle lift */
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        .denomination-chooser span.selected {
            background-color: #0056b3;
            color: #fff;
            border-color: #004085;
            font-weight: bold;
            /* 3. Improvement: Slightly enhance selected state */
             box-shadow: 0 1px 2px rgba(0,0,0,0.1) inset;
        }
        .denomination-chooser .placeholder { font-size: 0.9em; color: #6c757d; }
        /* Translation selector styling (unchanged) */
        .translation-select-wrapper { text-align: center; }
        .translation-select-wrapper label { margin-right: 0.5em; font-size: 0.9em; font-weight: 500; color: #495057; }
        .translation-select-wrapper select { padding: 0.4em 0.6em; border: 1px solid #ced4da; border-radius: 4px; font-size: 0.9em; max-width: 250px; }

        /* --- Titles Area Layout (unchanged) --- */
        .titles-area { display: grid; grid-template-columns: 1fr 1fr; gap: 2em; margin-bottom: 1em; padding: 0 1em; min-height: 1.5em; }

        /* --- Comparison Grid Layout (unchanged) --- */
        .comparison-grid { display: grid; grid-template-columns: 1fr 1fr; grid-auto-rows: auto; gap: 1em 2em; border-top: 2px solid #dee2e6; padding-top: 1em; }

        /* --- Grid Cell Styling (unchanged) --- */
        .grid-cell { padding: 1em; background-color: #fdfdff; border: 1px solid #eee; border-radius: 4px; align-self: start; min-height: 50px; }

        /* Content Styling (unchanged) */
        .preamble-text { font-style: italic; color: #555; margin-bottom: 1em; padding: 0.5em; background-color: #f0f0f0; border-left: 3px solid #6c757d; border-radius: 3px; }
        .commandment-text { margin-bottom: 0.8em; padding-left: 0.5em; border-left: 3px solid #007bff; }
        .commandment-text:last-child { margin-bottom: 0; }
        .placeholder { color: #6c757d; font-style: italic; text-align: center; padding: 2em 0; }
        .error-message { color: #dc3545; font-weight: bold; text-align: center; padding: 1em; border: 1px solid #f5c6cb; background-color: #f8d7da; border-radius: 5px;}
        .translation-note { display: block; font-size: 0.75em; color: #aaa; margin-top: 0.8em; text-align: right; }

         /* --- Responsive Styles (Keep as before) --- */
        @media (max-width: 768px) {
            body { padding: 0.5em; } /* Further reduced */
            .container { padding: 0.8em; } /* Further reduced */
            h1 { font-size: 1.4em; }
            .selectors-area { flex-direction: column; align-items: stretch; }
            .selector-group { min-width: unset; width: 100%; box-sizing: border-box; }
            .titles-area { grid-template-columns: 1fr; gap: 0.5em; }
            .comparison-grid { grid-template-columns: 1fr; gap: 1em; }
            .grid-cell { padding: 0.7em; }
            .commandment-text { font-size: 0.9em; } /* Adjust if needed */
            .preamble-text { font-size: 0.85em; }
            .denomination-chooser span { font-size: 0.8em; }
        }

    </style>
</head>

<body>

    <div class="container">
        <!-- 1. Update H1 Tag -->
        <h1>Ten Commandment Versions</h1>

        <!-- Selection Controls Area (Structure unchanged) -->
        <div class="selectors-area">
            <div class="selector-group">
                <div class="denomination-chooser" id="chooser-col1"><span class="placeholder">Loading...</span></div>
                <div class="translation-select-wrapper">
                    <label for="translation-select-col1">Translation 1:</label>
                    <select id="translation-select-col1"></select>
                </div>
            </div>
             <div class="selector-group">
                <div class="denomination-chooser" id="chooser-col2"><span class="placeholder">Loading...</span></div>
                <div class="translation-select-wrapper">
                    <label for="translation-select-col2">Translation 2:</label>
                    <select id="translation-select-col2"></select>
                </div>
            </div>
        </div>

        <!-- Titles Area (Structure unchanged) -->
        <div class="titles-area">
             <h2 id="title-col1">Version 1</h2>
             <h2 id="title-col2">Version 2</h2>
        </div>

        <!-- Comparison Grid Area (Structure unchanged) -->
        <div id="comparison-grid" class="comparison-grid">
             <div class="placeholder" style="grid-column: 1 / span 2;">Select versions above to compare.</div>
        </div>


        <footer>
            <p>Texts sourced from various translations. Ensure accuracy by consulting primary sources. Educational use only.</p>
        </footer>

    </div> <!-- End Container -->


     <!-- Main Application Script -->
     <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Constants (Unchanged) ---
            const TRANSLATIONS = { "ASV": "American Standard Version (ASV)", "DARBY": "Darby Translation (DARBY)", "DRA": "Douay-Rheims 1899 (DRA)", "KJV": "King James Version (KJV)", "WEB": "World English Bible (WEB)", "YLT": "Young's Literal Translation (YLT)", "RVA": "Reina-Valera Antigua (RVA)", "VULGATE": "Biblia Sacra Vulgata (VULGATE)" };
            const DEFAULT_TRANSLATION_KEY = 'WEB';
            const TRANSLATION_DATA_MAP = { "WEB": typeof webTranslationData !== 'undefined' ? webTranslationData : null, "KJV": typeof kjvTranslationData !== 'undefined' ? kjvTranslationData : null, "ASV": typeof asvTranslationData !== 'undefined' ? asvTranslationData : null, "DARBY": typeof darbyTranslationData !== 'undefined' ? darbyTranslationData : null, "DRA": typeof draTranslationData !== 'undefined' ? draTranslationData : null, "YLT": typeof yltTranslationData !== 'undefined' ? yltTranslationData : null, "RVA": typeof rvaTranslationData !== 'undefined' ? rvaTranslationData : null, "VULGATE": typeof vulgateTranslationData !== 'undefined' ? vulgateTranslationData : null };
            const MAX_COMMANDMENT_NUM = 10;

            // --- State Variables (Unchanged) ---
            let selectedDenominationKey1 = null;
            let selectedDenominationKey2 = null;
            let selectedTranslationKey1 = DEFAULT_TRANSLATION_KEY;
            let selectedTranslationKey2 = DEFAULT_TRANSLATION_KEY;

            // --- DOM References (Unchanged) ---
            const chooserCol1 = document.getElementById('chooser-col1');
            const chooserCol2 = document.getElementById('chooser-col2');
            const translationSelectCol1 = document.getElementById('translation-select-col1');
            const translationSelectCol2 = document.getElementById('translation-select-col2');
            const comparisonGrid = document.getElementById('comparison-grid');
            const titleCol1 = document.getElementById('title-col1');
            const titleCol2 = document.getElementById('title-col2');

            // --- Helper Functions (getDenominationData, getCommandmentPartsForNumber - Unchanged) ---
             function getDenominationData(denominationKey, translationKey) { /* ... no change ... */ }
             function getCommandmentPartsForNumber(denominationData, targetNumber, denominationKey) { /* ... no change ... */ }

            // --- Helper: Shorten Name ---
            // 2. Function to remove parenthetical parts
            function getShortName(fullName) {
                if (!fullName) return '';
                // Remove space, parenthesis, content, parenthesis, space at the end
                return fullName.replace(/\s*\(.*\)\s*$/, '').trim();
            }


            // --- Helper: Update Display ---
            function updateDisplay() {
                comparisonGrid.innerHTML = ''; // Clear grid

                const result1 = getDenominationData(selectedDenominationKey1, selectedTranslationKey1);
                const result2 = getDenominationData(selectedDenominationKey2, selectedTranslationKey2);

                // Update Titles - 2. Use shortened name
                const name1 = result1.data?.name || selectedDenominationKey1 || 'Version 1';
                const name2 = result2.data?.name || selectedDenominationKey2 || 'Version 2';
                titleCol1.textContent = getShortName(name1);
                titleCol2.textContent = getShortName(name2);


                // Error handling for missing default data (Unchanged)
                 let hasFatalError = false;
                 if (result1.error && !result1.data && result1.error.includes("Missing default data")) hasFatalError = true;
                 if (result2.error && !result2.data && result2.error.includes("Missing default data")) hasFatalError = true;
                 if(hasFatalError){ /* ... show fatal error ... */ return; }

                // Loop through Commandment Numbers (Unchanged loop structure)
                for (let i = 1; i <= MAX_COMMANDMENT_NUM; i++) {
                     // Create cell function (Unchanged logic inside createCell)
                     const createCell = (colNum, result, denominationKey) => { /* ... no change ... */ };
                     // Create and append cells (Unchanged)
                     comparisonGrid.appendChild(createCell(1, result1, selectedDenominationKey1));
                     comparisonGrid.appendChild(createCell(2, result2, selectedDenominationKey2));
                }

                // Update selected styles in denomination choosers (Unchanged)
                updateChooserSelection(chooserCol1, selectedDenominationKey1);
                updateChooserSelection(chooserCol2, selectedDenominationKey2);
            } // End updateDisplay


            // --- Other Helpers and Event Handlers (Unchanged logic) ---
            function updateChooserSelection(chooserElement, selectedKey) { /* ... no change ... */ }
            function populateTranslationSelect(selectElement) { /* ... no change ... */ }
            function handleDenominationClick(event, columnNumber) { /* ... no change ... */ }
            function handleTranslationChange(event, columnNumber) { /* ... no change ... */ }


            // --- Initialization Function ---
            function initializeApp() {
                 if (!TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]) { /* ... error handling ... */ return; }

                // Populate Translation Selectors (Unchanged)
                populateTranslationSelect(translationSelectCol1);
                populateTranslationSelect(translationSelectCol2);

                // Populate Denomination Choosers
                chooserCol1.innerHTML = ''; // Clear loading placeholder
                chooserCol2.innerHTML = '';
                const denominationKeys = Object.keys(TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]);
                denominationKeys.sort((a, b) => { /* ... sorting logic ... */ });

                denominationKeys.forEach(key => {
                    const fullName = TRANSLATION_DATA_MAP[DEFAULT_TRANSLATION_KEY]?.[key]?.name || key;
                    // 2. Use shortened name for the pill text
                    const shortName = getShortName(fullName);
                    // Col 1
                    const span1 = document.createElement('span'); span1.textContent = shortName; span1.dataset.key = key; chooserCol1.appendChild(span1);
                    // Col 2
                    const span2 = document.createElement('span'); span2.textContent = shortName; span2.dataset.key = key; chooserCol2.appendChild(span2);
                });

                // Add Event Listeners (Unchanged)
                chooserCol1.addEventListener('click', (event) => handleDenominationClick(event, 1));
                chooserCol2.addEventListener('click', (event) => handleDenominationClick(event, 2));
                translationSelectCol1.addEventListener('change', (event) => handleTranslationChange(event, 1));
                translationSelectCol2.addEventListener('change', (event) => handleTranslationChange(event, 2));

                // Read initial translation selections (Unchanged)
                selectedTranslationKey1 = translationSelectCol1.value;
                selectedTranslationKey2 = translationSelectCol2.value;

                // Initial render (Unchanged)
                updateDisplay();
            } // End initializeApp

            // --- Run Initialization ---
            initializeApp();

        }); // End DOMContentLoaded
    </script>

</body>
</html>